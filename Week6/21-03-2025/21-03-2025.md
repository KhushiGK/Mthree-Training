## Changes to `complete-react-sre-script.sh`

### Change 1
- **Original Line:**
  ```bash
  if ! grep -q Microsoft /proc/version; then
  ```
- **Updated Line:**
  ```bash
  if ! grep -qEi "(microsoft|wsl)" /proc/version; then
  ```
- **Line Number:** 82 (approximate, verify in the actual file)

**Description:** This change expands the check for WSL by making it case-insensitive and including variations like "wsl" explicitly.

---

## Changes to `deploy_app.py`

### Change 2
- **Original Function:** `create_namespaces`
  ```python
  def create_namespaces():
      """Create necessary Kubernetes namespaces."""
      log("INFO", "Creating Kubernetes namespaces...")
  
      namespaces = ["react-sre-app", "monitoring"]
      for namespace in namespaces:
          result = run_command([
              KUBECTL_CMD, "create", "namespace", namespace, "--dry-run=client", "-o", "yaml"
          ], timeout=10)
  
          if result is None:
              log("ERROR", f"Failed to generate namespace YAML for {namespace}")
              return False
  
          apply_result = run_command(f"{KUBECTL_CMD} apply -f -", timeout=10, shell=True, retry=3)
  
          if apply_result is None:
              log("ERROR", f"Failed to create namespace {namespace}")
              return False
  
      log("INFO", "Kubernetes namespaces created successfully")
      return True
  ```
- **Updated Function:**
  ```python
  def create_namespaces():
      """Ensure necessary Kubernetes namespaces exist."""
      log("INFO", "Ensuring required Kubernetes namespaces exist...")
  
      namespaces = ["react-sre-app", "monitoring"]
      for namespace in namespaces:
          if namespace_exists(namespace):
              log("INFO", f"Namespace '{namespace}' already exists. Skipping creation.")
              continue
  
          log("INFO", f"Creating namespace: {namespace}")
  
          create_result = run_command(
              [KUBECTL_CMD, "create", "namespace", namespace],
              timeout=10,
              retry=3
          )
  
          if create_result is None:
              log("ERROR", f"Failed to create namespace '{namespace}'")
              return False
  
      log("INFO", "All required namespaces are ready.")
      return True
  ```
- **Line Number:** 285 (approximate, verify in the actual file)

### Change 3
- **New Function:** `namespace_exists`
  ```python
  def namespace_exists(namespace):
      """Check if a Kubernetes namespace already exists."""
      result = run_command(
          [KUBECTL_CMD, "get", "namespace", namespace, "-o", "jsonpath={.metadata.name}"],
          timeout=10
      )
      return result is not None and namespace in result
  ```
- **Line Number:** 275 (approximate, verify in the actual file)

**Description:** Added a function `namespace_exists` to check if a namespace exists before attempting creation, improving efficiency and avoiding redundant operations.

### Change 4
- **Updated Function:** `run_command`
  - **Added Parameter:** `cwd=None`
  - **Updated `subprocess.run` Calls:** Included `cwd=cwd` to allow specifying the working directory.
  - **Line Number:** 120 (approximate, verify in the actual file)

---

## Changes to `nginx.conf`

### Change 5
- **Updated Configuration:** Modified `/health` and `/metrics` endpoints.
- **File:** `nginx.conf`

---

## Changes to `deployment.yaml`

### Change 6
- **Updated Configuration:** Adjusted deployment settings, including Prometheus annotations, ports, and container image.
- **File:** `deployment.yaml`

---

## Final Steps

After making these changes, run the following commands to apply them:
```bash
# Start Docker
sudo systemctl start docker || sudo service docker start

# Delete existing Minikube cluster
minikube delete

# Start Minikube
minikube start

# Run the deployment script
./deploy_sre_app.sh
```

This ensures that all updates take effect properly and the React SRE application is deployed successfully.

